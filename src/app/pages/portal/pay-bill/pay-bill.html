<div class="container-fluid p-4 d-flex justify-content-center">
  <mat-card class="mat-elevation-z3 w-100" style="max-width: 650px;">
    
    <mat-card-header class="bg-primary text-white p-3 rounded-top mb-3">
      <div mat-card-avatar>
        <mat-icon class="fs-1 mt-1 text-white">receipt</mat-icon>
      </div>
      <mat-card-title class="m-0 fs-4 mt-2">Pay Utility Bill</mat-card-title>
    </mat-card-header>

    <mat-card-content class="p-4">
      <form [formGroup]="payBillForm" (ngSubmit)="onSubmit()">
        
        <mat-form-field appearance="outline" class="w-100 mb-2">
          <mat-label>Pay From Account</mat-label>
          <mat-select formControlName="fromAccount">
            <mat-option *ngFor="let acc of accounts" [value]="acc.accountNumber">
              {{ acc.accountNumber }} - {{ acc.accountType }} (Bal: ₹{{ acc.balance | number:'1.2-2' }})
            </mat-option>
          </mat-select>
          <mat-icon matSuffix>account_balance_wallet</mat-icon>
          <mat-error>Please select an account</mat-error>
        </mat-form-field>

        <div class="row">
          <div class="col-md-6">
            <mat-form-field appearance="outline" class="w-100 mb-2">
              <mat-label>Biller Category</mat-label>
              <mat-select formControlName="billerCategory">
                <mat-option value="ELECTRICITY">Electricity</mat-option>
                <mat-option value="TELEPHONE">Telephone</mat-option>
                <mat-option value="CELL_PHONE">Cell Phone</mat-option>
                <mat-option value="WATER">Water</mat-option>
              </mat-select>
              <mat-icon matSuffix>category</mat-icon>
            </mat-form-field>
          </div>

          <div class="col-md-6">
            <mat-form-field appearance="outline" class="w-100 mb-2">
              <mat-label>Biller Name / Provider</mat-label>
              <input matInput formControlName="billerName" placeholder="e.g. Tata Power, Airtel">
              <mat-icon matSuffix>business</mat-icon>
            </mat-form-field>
          </div>
        </div>

        <mat-form-field appearance="outline" class="w-100 mb-2">
          <mat-label>Consumer Number / Bill ID</mat-label>
          <input matInput formControlName="consumerNumber" placeholder="Enter your bill or consumer number">
          <mat-icon matSuffix>tag</mat-icon>
        </mat-form-field>

        <mat-form-field appearance="outline" class="w-100 mb-3">
          <mat-label>Amount (₹)</mat-label>
          <input matInput type="number" formControlName="amount" placeholder="0.00" min="1">
          <mat-icon matPrefix class="me-2">currency_rupee</mat-icon>
        </mat-form-field>

        <div class="mb-4 p-3 border rounded bg-light">
          <p class="mb-2 fw-bold text-secondary">Payment Timing</p>
          <mat-radio-group formControlName="paymentTiming" color="primary" class="d-flex flex-column gap-2">
            <mat-radio-button value="IMMEDIATE">Pay Immediately</mat-radio-button>
            <mat-radio-button value="SCHEDULED">Schedule for Later Date</mat-radio-button>
          </mat-radio-group>

          <mat-form-field appearance="outline" class="w-100 mt-3 mb-0" *ngIf="payBillForm.get('paymentTiming')?.value === 'SCHEDULED'">
            <mat-label>Select Payment Date</mat-label>
            <input matInput [matDatepicker]="picker" formControlName="scheduledDate" [min]="minDate">
            <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
          </mat-form-field>
        </div>

        <button mat-raised-button color="primary" class="w-100 py-2 fs-6" type="submit" [disabled]="payBillForm.invalid">
          <mat-icon>offline_pin</mat-icon> 
          {{ payBillForm.get('paymentTiming')?.value === 'SCHEDULED' ? 'Schedule Payment' : 'Pay Bill Now' }}
        </button>

      </form>
    </mat-card-content>
  </mat-card>
</div>